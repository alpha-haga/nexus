spring:
  application:
    name: nexus-api

  # データソース設定（JPA用 - 開発用H2）
  # 注意: この設定は既存のJPA Entity用
  # NEXUS DB接続基盤は nexus.datasource を使用
  datasource:
    url: jdbc:h2:mem:nexusdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password:

  # JPA設定
  jpa:
    hibernate:
      ddl-auto: create-drop
    show-sql: true
    properties:
      hibernate:
        format_sql: true

  # H2コンソール（開発用）
  h2:
    console:
      enabled: true
      path: /h2-console

# サーバー設定
server:
  port: 8080

# Actuator設定
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics

# OpenAPI設定
springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html

# ロギング
logging:
  level:
    nexus: DEBUG
    org.hibernate.SQL: DEBUG

# ===========================================
# NEXUS DB接続基盤設定
# ===========================================
# 接続単位（厳守）:
# - 地区DB × 3（gojo, funeral, accounting 等の業務ドメイン用）
# - 統合DB × 1（nexus-group 専用）
#
# 禁止事項:
# - 法人単位での DataSource 作成禁止
# - tenant_id ごとの接続切り替え禁止
# ===========================================
nexus:
  datasource:
    # 統合DB（integration） - nexus-group 専用
    # 法人横断検索で使用
    integration:
      # 開発環境: H2
      url: jdbc:h2:mem:nexus_integration;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
      driver-class-name: org.h2.Driver
      username: sa
      password:
      # 本番環境: Oracle（コメントアウト）
      # url: jdbc:oracle:thin:@//db-integration.nexus.local:1521/NEXUSINT
      # driver-class-name: oracle.jdbc.OracleDriver
      # username: nexus_integration
      # password: ${NEXUS_INTEGRATION_DB_PASSWORD}
      hikari:
        maximum-pool-size: 10
        minimum-idle: 2
        connection-timeout: 30000
        pool-name: nexus-integration

    # 地区DB（regions） - 業務ドメイン用
    # regionId をキーとして複数のDBを管理
    regions:
      # 東京地区DB
      tokyo:
        url: jdbc:h2:mem:nexus_tokyo;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
        driver-class-name: org.h2.Driver
        username: sa
        password:
        # 本番環境: Oracle
        # url: jdbc:oracle:thin:@//db-tokyo.nexus.local:1521/NEXUSTKY
        # driver-class-name: oracle.jdbc.OracleDriver
        # username: nexus_tokyo
        # password: ${NEXUS_TOKYO_DB_PASSWORD}
        hikari:
          maximum-pool-size: 20
          minimum-idle: 5
          pool-name: nexus-region-tokyo

      # 大阪地区DB
      osaka:
        url: jdbc:h2:mem:nexus_osaka;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
        driver-class-name: org.h2.Driver
        username: sa
        password:
        # 本番環境: Oracle
        # url: jdbc:oracle:thin:@//db-osaka.nexus.local:1521/NEXUSOSK
        # driver-class-name: oracle.jdbc.OracleDriver
        # username: nexus_osaka
        # password: ${NEXUS_OSAKA_DB_PASSWORD}
        hikari:
          maximum-pool-size: 20
          minimum-idle: 5
          pool-name: nexus-region-osaka

      # 福岡地区DB
      fukuoka:
        url: jdbc:h2:mem:nexus_fukuoka;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
        driver-class-name: org.h2.Driver
        username: sa
        password:
        # 本番環境: Oracle
        # url: jdbc:oracle:thin:@//db-fukuoka.nexus.local:1521/NEXUSFUK
        # driver-class-name: oracle.jdbc.OracleDriver
        # username: nexus_fukuoka
        # password: ${NEXUS_FUKUOKA_DB_PASSWORD}
        hikari:
          maximum-pool-size: 15
          minimum-idle: 3
          pool-name: nexus-region-fukuoka
